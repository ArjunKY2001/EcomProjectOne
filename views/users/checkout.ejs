<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <title></title>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title" content="">
    <meta property="og:type" content="">
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="/static/userAssets/imgs/theme/favicon.svg">
    <!-- Template CSS -->
    <link rel="stylesheet" href="/static/userAssets/css/main.css?v=3.4">
</head>

<body>
    <header class="header-area header-style-1 header-height-2">
        <div class="header-top header-top-ptb-1 d-none d-lg-block">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-xl-3 col-lg-4">
                        <div class="header-info">
                            <ul>
                            </ul>
                        </div>
                    </div>
                    <div class="col-xl-6 col-lg-4">
                        <div class="text-center">
                            <div id="news-flash" class="d-inline-block">
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-lg-4">
                        <div class="header-info header-info-right">
                            
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="header-middle header-middle-ptb-1 d-none d-lg-block">
            <div class="container">
                <div class="header-wrap">
                    <div class="logo logo-width-1">
                        <a href="index.html"></a>
                    </div>
                    <div class="header-right">
                        <div class="search-style-2">
                        </div>
                        <div class="header-action-right">
                            <div class="header-action-2">
                                <div class="header-action-icon-2">
                                    <!-- <a href="shop-wishlist.html">
                                        <img class="svgInject" alt="Evara" src="/static/userAssets/imgs/theme/icons/icon-heart.svg">
                                        <span class="pro-count blue">4</span>
                                    </a> -->
                                </div>
                                <div class="header-action-icon-2">
                                    <!-- <a class="mini-cart-icon" href="shop-cart.html">
                                        <img alt="Evara" src="/static/userAssets/imgs/theme/icons/icon-cart.svg">
                                        <span class="pro-count blue">2</span>
                                    </a> -->
                                    <div class="cart-dropdown-wrap cart-dropdown-hm2">
                                        <ul>
                                            <li>
                                                <div class="shopping-cart-img">
                                                    <a href="shop-product-right.html"><img alt="Evara" src="/static/userAssets/imgs/shop/thumbnail-3.jpg"></a>
                                                </div>
                                                <div class="shopping-cart-title">
                                                    <h4><a href="shop-product-right.html">Daisy Casual Bag</a></h4>
                                                    <h4><span>1 × </span>$800.00</h4>
                                                </div>
                                                <div class="shopping-cart-delete">
                                                    <a href="#"><i class="fi-rs-cross-small"></i></a>
                                                </div>
                                            </li>
                                            <li>
                                                <div class="shopping-cart-img">
                                                    <a href="shop-product-right.html"><img alt="Evara" src="/static/userAssets/imgs/shop/thumbnail-2.jpg"></a>
                                                </div>
                                                <div class="shopping-cart-title">
                                                    <h4><a href="shop-product-right.html">Corduroy Shirts</a></h4>
                                                    <h4><span>1 × </span>$3200.00</h4>
                                                </div>
                                                <div class="shopping-cart-delete">
                                                    <a href="#"><i class="fi-rs-cross-small"></i></a>
                                                </div>
                                            </li>
                                        </ul>
                                        <div class="shopping-cart-footer">
                                            <div class="shopping-cart-total">
                                                <h4>Total <span>$4000.00</span></h4>
                                            </div>
                                            <div class="shopping-cart-button">
                                                <a href="shop-cart.html" class="outline">View cart</a>
                                                <a href="shop-checkout.html">Checkout</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="header-bottom header-bottom-bg-color sticky-bar">
            <div class="container">
                <div class="header-wrap header-space-between position-relative">
                    <div class="logo logo-width-1 d-block d-lg-none">
                        <a href="index.html"><img src="/static/userAssets/imgs/theme/logo.svg" alt="logo"></a>
                    </div>
                    
                    
                </div>
            </div>
        </div>
    </header>
    <div class="mobile-header-active mobile-header-wrapper-style">
        <div class="mobile-header-wrapper-inner">
            <div class="mobile-header-top">
                <div class="mobile-header-logo">
                    <a href="index.html"><img src="/static/userAssets/imgs/theme/logo.svg" alt="logo"></a>
                </div>
                <div class="mobile-menu-close close-style-wrap close-style-position-inherit">
                    <button class="close-style search-close">
                        <i class="icon-top"></i>
                        <i class="icon-bottom"></i>
                    </button>
                </div>
            </div>
            <div class="mobile-header-content-area">
                <div class="mobile-search search-style-3 mobile-header-border">
                    <form action="#">
                        <input type="text" placeholder="Search for items…">
                        <button type="submit"><i class="fi-rs-search"></i></button>
                    </form>
                </div>
                <div class="mobile-header-info-wrap mobile-header-border">
                    <div class="single-mobile-header-info mt-30">
                        <a  href="page-contact.html"> Our location </a>
                    </div>
                    <div class="single-mobile-header-info">
                        <a href="page-login-register.html">Log In / Sign Up </a>
                    </div>
                </div>
                <div class="mobile-social-icon">
                    <h5 class="mb-15 text-grey-4">Follow Us</h5>
                    <a href="#"><img src="/static/userAssets/imgs/theme/icons/icon-facebook.svg" alt=""></a>
                    <a href="#"><img src="/static/userAssets/imgs/theme/icons/icon-twitter.svg" alt=""></a>
                    <a href="#"><img src="/static/userAssets/imgs/theme/icons/icon-instagram.svg" alt=""></a>
                    <a href="#"><img src="/static/userAssets/imgs/theme/icons/icon-pinterest.svg" alt=""></a>
                    <a href="#"><img src="/static/userAssets/imgs/theme/icons/icon-youtube.svg" alt=""></a>
                </div>
            </div>
        </div>
    </div>
    <main class="main">
        <div class="page-header breadcrumb-wrap">
            <div class="container">
                <div class="breadcrumb">
                    <a href="/user/home" >Home</a>
                    <span></span> Shop
                    <span></span> Checkout
                </div>
            </div>
        </div>
        <section class="mt-50 mb-50">
            <div class="container">
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-25">
                            <h4>Billing Details</h4>
                        </div>
                            <select class="form-select d-inline-block "  id="select-address" >
                                <option selected>Select address</option>
                                <option value="addAddress">New address</option>
                                <% let num; %>
                                <%for(let i=0;i<address.length;i++){ %>
                                <option  value="<%=address[i]._id  %>">address <%= i+1 %></option>
                                <% num=i %>
                                <% } %>
                            </select>
                            <h5>House</h5>
                            <div class="form-group">
                                <input type="text" required="" id="houseName" name="fname" value="<%=address.houseName %>">
                            </div>
                            <h5>Place</h5>
                            <div class="form-group">
                                <input required="" type="text"  id="place"  name="city" >
                            </div>
                            <h5>District</h5>
                            <div class="form-group">
                                <input required="" type="text" id="district"  name="state" >
                            </div>
                            <h5>Pincode</h5>
                            <div class="form-group">
                                <input required="" type="text" id="pinCode"  name="zipcode" >
                            </div>
                            <h5>Phone</h5>
                            <div class="form-group">
                                <input required="" type="text"  id="phone" name="phone" >
                            </div>
                            <h5>Email</h5>
                            <div class="form-group">
                                <input required="" type="text" id="userEmail"  name="email" >
                                <input required="" type="hidden" id="addressId"  name="addressId" >
                            </div>
                            <div id="collapsePassword" class="form-group create-account collapse in">
                                <input required="" type="password" placeholder="Password" name="password">
                            </div>
                            <div class="ship_detail">
                            </div>
                        
                    </div>
                    <div class="col-md-6">
                        <div class="order_review">
                            <div class="mb-20">
                                <h4>Your Orders</h4>
                            </div>
                            <div class="table-responsive order_table text-center">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th colspan="2">Product</th>
                                            <th>SubTotal</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <% let totalPrice = 0 %>
                                        <%for(let i=0;i<cart.items.length;i++){ %>
                                        <tr>
                                            <td class="image product-thumbnail"><% if (cart.items[i].product && cart.items[i].product.images && cart.items[i].product.images.length > 0) { %>
                                                <img src="/<%=cart.items[i].product.images[0] %>">
                                                <% } else { %>
                                                    <span>No Image Available</span>
                                                <% } %></td>
                                            <td>
                                                <% if (cart.items[i].product && cart.items[i].product.name) { %>
                                                    <h5 class="product-name"><a href="shop-product-right.html"><%=cart.items[i].product.name %></a></h5>
                                                <% } else { %>
                                                    <span>No Product Name Available</span>
                                                <% } %>
                                            </td>
                                            <td><%= cart.items[i].subtotal %></td>
                                            <% totalPrice += cart.items[i].quantity * cart.items[i].product.price %>
                                        </tr>
                                        <% } %>
                                        <!-- <tr>
                                            <th>SubTotal</th>
                                            <td class="product-subtotal" colspan="2">$280.00</td>
                                        </tr> -->
                                        <!-- <tr>
                                            <th>Shipping</th>
                                            <td colspan="2"><em>Free Shipping</em></td>
                                        </tr> -->
                                        <tr>
                                            <th>Total</th>
                                            <td colspan="2" class="product-subtotal">$<span class="font-xl text-brand fw-900" id="totalPrice"><%= cart.totalPrice %></span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="bt-1 border-color-1 mt-30 mb-30"></div>
                            <div class="payment_method">
                                <div class="mb-25">
                                    <h5>Payment</h5>
                                </div>
                                <div class="payment_option">
                                    <div class="custome-radio">
                                        <input class="form-check-input" required="" type="radio" name="payment_option" id="exampleRadios3" checked="">
                                        <label class="form-check-label" for="exampleRadios3" data-bs-toggle="collapse" data-target="#bankTranfer" aria-controls="bankTranfer">Direct Bank Transfer</label>
                                        <div class="form-group collapse in" id="bankTranfer">
                                            <p class="text-muted mt-5">There are many variations of passages of Lorem Ipsum available, but the majority have suffered alteration. </p>
                                        </div>
                                    </div>
                                    <div class="custome-radio">
                                        <input class="form-check-input" required="" type="radio" name="payment_option" id="exampleRadios4" checked="">
                                        <label class="form-check-label" for="exampleRadios4" data-bs-toggle="collapse" data-target="#checkPayment" aria-controls="checkPayment">Check Payment</label>
                                        <div class="form-group collapse in" id="checkPayment">
                                            <p class="text-muted mt-5">Please send your cheque to Store Name, Store Street, Store Town, Store State / County, Store Postcode. </p>
                                        </div>
                                    </div>
                                    <div class="custome-radio">
                                        <input class="form-check-input" required="" type="radio" name="payment_option" id="exampleRadios5" checked="">
                                        <label class="form-check-label" for="exampleRadios5" data-bs-toggle="collapse" data-target="#paypal" aria-controls="paypal">Cash on delivery</label>
                                        <div class="form-group collapse in" id="paypal">
                                            <p class="text-muted mt-5">Pay via PayPal; you can pay with your credit card if you don't have a PayPal account.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <button class="btn" onclick="Cashondelivery()">Place order</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
    <footer class="main">
       
    </footer>
    <!-- Preloader Start -->
    <!-- Vendor JS-->
    <script>
        const houseName = document.getElementById('houseName')
        const place = document.getElementById('place')
        const district = document.getElementById('district')
        const pinCode = document.getElementById('pinCode')
        const email = document.getElementById('userEmail')
        const phone = document.getElementById('phone')
        const addressId = document.getElementById('addressId')
        const totalPrice=document.getElementById('totalPrice')
        const selectedAddressId=document.getElementById('addressId').value

        document.getElementById('select-address').addEventListener('change', function () {
            const selectedAddressId = this.value; // Get the selected option's value (_id)

            if(selectedAddressId==="addAddress"){
                window.location.href='/user/checkoutaddAddress?checkout'
            }else{
            fetch(`/user/checkoutPage?selectedAddressId=${selectedAddressId}`, {
                method: 'PATCH',
                headers: {
                    'Content-Type': 'application/json'
                },
                // body: JSON.stringify({ addressId: selectedAddressId })
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    // Handle the response from the backend if needed
                    console.log(data);
                    houseName.value = data.houseName
                    place.value = data.place
                    district.value = data.district
                    pinCode.value = data.pinCode
                    phone.value=data.phone
                    email.value = data.userEmail
                    addressId.value = data._id
                })
                .catch(error => {
                    // Handle errors
                    console.error('There was a problem with your fetch operation:', error);
                });
            }
        });
    

    </script>
    <script>
 function Cashondelivery(){
     var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    var mobileRegex = /^\d{10}$/;
    var pinRegex = /^\d{6}$/;
if (houseName.value.trim()==="") {
    alert("houseName must be at least 3 characters");
}if (place.value.trim()==="") {
    alert("place must be at least 3 characters");
}if (district.value.trim()==="") {
    alert("district must be at least 3 characters");
}if (pinCode.value.trim()==="") {
    alert("pinCode must be at least 3 characters");
}if (email.value.trim()==="") {
    alert("email must be at least 3 characters");
    console.log(" yess");
// }if (!emailRegex.test(email)) {
//     alert("Invalid email format");
//      return false;
}if (phone.value.trim()==="") {
    alert("district must be at least 3 characters");
// }if (!mobileRegex.test(phone.replace(/\s/g, ''))) {
//     alert("Invalid mobile number");
}else{
        
        fetch(`/user/loadinvoice?adrs=${addressId.value}&totalprc=${totalPrice.textContent}`,{
            method:'GET',
            headers:{"Content-Type":"application/json"}
        })
        setTimeout(()=>{
            window.location.href="/user/thanks"
        },500)
    }
    }
    </script>
    <script src="/static/userAssets/js/vendor/modernizr-3.6.0.min.js"></script>
    <script src="/static/userAssets/js/vendor/jquery-3.6.0.min.js"></script>
    <script src="/static/userAssets/js/vendor/jquery-migrate-3.3.0.min.js"></script>
    <script src="/static/userAssets/js/vendor/bootstrap.bundle.min.js"></script>
    <script src="/static/userAssets/js/plugins/slick.js"></script>
    <script src="/static/userAssets/js/plugins/jquery.syotimer.min.js"></script>
    <script src="/static/userAssets/js/plugins/wow.js"></script>
    <script src="/static/userAssets/js/plugins/jquery-ui.js"></script>
    <script src="/static/userAssets/js/plugins/perfect-scrollbar.js"></script>
    <script src="/static/userAssets/js/plugins/magnific-popup.js"></script>
    <script src="/static/userAssets/js/plugins/select2.min.js"></script>
    <script src="/static/userAssets/js/plugins/waypoints.js"></script>
    <script src="/static/userAssets/js/plugins/counterup.js"></script>
    <script src="/static/userAssets/js/plugins/jquery.countdown.min.js"></script>
    <script src="/static/userAssets/js/plugins/images-loaded.js"></script>
    <script src="/static/userAssets/js/plugins/isotope.js"></script>
    <script src="/static/userAssets/js/plugins/scrollup.js"></script>
    <script src="/static/userAssets/js/plugins/jquery.vticker-min.js"></script>
    <!-- Template  JS -->
    <script src="/static/userAssets/js/main.js?v=3.4"></script>
    <script src="/static/userAssets/js/shop.js?v=3.4"></script>
</body>

</html>